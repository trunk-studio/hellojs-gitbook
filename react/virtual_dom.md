#Virtual DOM

##為何要使用Virtual Dom?

DOM 操作的效能成本非常的高，React 為了解決開發者在手動操作 DOM 時可能造成的效能低落或失誤，建立了一套虛擬 DOM（ Virtual DOM，以下簡稱 VDOM）的機制，程式記憶體中將有一份對應真正 DOM 的 VDOM 物件，以代管 UI 儲存的資料與邏輯。當一個 UI 因為資料改變而需要進行畫面變動的時候，React 會根據新的 UI 狀態重繪一份新的 VDOM Tree，並且與變動前的舊 VDOM Tree 以高效率的 Diff 演算法進行比對，然後其中的差異才會真正的由 React 自動幫你更新到實際的 DOM 上，反應出畫面的變更。

透過 VDOM 的機制，開發者將不必煩惱如何操作 DOM，而可以專心於撰寫 UI 的定義與互動邏輯。並且由於 React 能夠自動去最佳化的處理 DOM 操作，前端 UI 程式將可以有效的降低操作成本而達到優秀的效能。


###從 Virtual DOM 生成DOM 帶來了一些好處

* 標籤之間的空格從一開始就被排除，不會帶來意外的空白元素的字符串被自動轉義，不會那麼容易導致代碼注入

* JSON 的Tree 很容易組合，組件化很自然就實現出來了
同時，JavaScript 可以在 Node.js 和瀏覽器同時運行，能夠共享代碼同時得益於 DOM 會自動完成Diff 和 Patch，DOM 樹就能夠自動隨著數據改變進行更新，更新 DOM 。就像是 MVC 描述的那樣，Model 被更新，View 就跟著更新，就這麼簡單


###Virtual DOM 

* 是一份純資料的 Tree 物件，對應到實際的 DOM

* 是自定義 Component 提供了中介的虛擬層，讓開發者能描述 UI 樣貌與邏輯

我們透過定義 Component 來表達「UI 什麼情況該如何呈現」。而「要用什麼手段來達到這個畫面改變（如何操作 DOM）」 ，React 則會自動幫你做，而且絕大多數情況下都比你自己來要做的更好

###Single Source of Truth

* UI 要長得如何，應當是取決於當時的 Model 資料以及 UI 狀態而決定

* 把畫面全部洗掉重新再畫，顯示結果通常一定是正確的

* 每次都重繪全部的實體 DOM 顯然是不可行，但是重繪 VDOM 則相對高效許多


當畫面需要改變時，根據最新的 UI 狀態重繪出新的 VDOM Tree並與改變前的舊 VDOM Tree 進行全面式的比較與計算，其中新舊差異的地方，才真的會在實際的 DOM 上發生操作改變

